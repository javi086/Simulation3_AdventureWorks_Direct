CMD: sqlcmd -S . -d AdventureWorks2022 -Q "SELECT TOP (10) h.SalesOrderID, CONVERT(date,h.OrderDate) AS OrderDate, COALESCE(p.FirstName + ' ' + p.LastName, s.Name) AS CustomerName, h.SubTotal, h.TaxAmt, h.Freight, h.TotalDue FROM Sales.SalesOrderHeader h JOIN Sales.Customer c ON c.CustomerID=h.CustomerID LEFT JOIN Person.Person p ON p.BusinessEntityID=c.PersonID LEFT JOIN Sales.Store s ON s.BusinessEntityID=c.StoreID ORDER BY h.TotalDue DESC;"
CSV: sqlcmd -S . -d AdventureWorks2022 -Q "SELECT TOP (10) h.SalesOrderID, CONVERT(date,h.OrderDate) AS OrderDate, COALESCE(p.FirstName + ' ' + p.LastName, s.Name) AS CustomerName, h.TotalDue FROM Sales.SalesOrderHeader h JOIN Sales.Customer c ON c.CustomerID=h.CustomerID LEFT JOIN Person.Person p ON p.BusinessEntityID=c.PersonID LEFT JOIN Sales.Store s ON s.BusinessEntityID=c.StoreID ORDER BY h.TotalDue DESC;" -s "," -W -h-1 > "C:\temp\top_orders.csv"
Installation: winget install sqlcmd